{{- $f1 := true}}
[{{- range .Matches }}
    {{- $cve := "Dummy CVE"}}
    {{- $severity := "Dummy Severity"}}
    {{- $cvss := "Dummy Cvss"}}
    {{- if ne .Vulnerability.Namespace "nvd:cpe"}}
        {{- range .RelatedVulnerabilities }}
            {{- if eq .Namespace "nvd:cpe"}}
                {{- if $f1}}
                    {{$f1 = false}}
                {{- else}}
                    ,
                {{- end}}
                {{- $cve = .ID}}
                {{- $severity = .Severity}}
                {{- $cvss = .Cvss}}
            {{- end}}
        {{- end}}
    {{- else}}
            {{- if $f1}}
                {{$f1 = false}}
            {{- else}}
                ,
            {{- end}}
            {{- $cve = .Vulnerability.ID}}
            {{- $severity = .Vulnerability.Severity}}
            {{- $cvss = .Vulnerability.Cvss}}
    {{- end}}

    {{- if ne $severity "Dummy Severity"}}
        {{- $f2 := true}}
        {{- range .MatchDetails}}
            {{- if $f2}}
                {{$f2 = false}}
            {{- else}}
                ,
            {{- end}}
    {
    {{- $type := printf "%T" .SearchedBy }}
    "cve" : "{{$cve}}",
    "package": {{- if ne $type "search.CPEParameters"}}"{{.SearchedBy.package.name}}"{{- else}}"N/A"{{- end}},
    "version": {{- if ne $type "search.CPEParameters"}}"{{.SearchedBy.package.version}}"{{- else}}"N/A"{{- end}},
    "severity": "{{$severity}}",
    {{- $f3 := true}}
    "cvss" :[
    {{- range $cvss}}
        {{- if $f3}}
            {{$f3 = false}}
        {{- else}}
            ,
        {{- end}}
        {
            "version" : "{{.Version}}",
            "baseScore" : "{{.Metrics.BaseScore}}",
            "exploitabilityScore" : "{{.Metrics.ExploitabilityScore}}",
            "impactScore" : "{{.Metrics.ImpactScore}}"
        }
    {{- end}}
    ]
    }
        {{- end}}
    {{- end -}}
{{- end }}]
